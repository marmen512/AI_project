# ‚úÖ –ó–≤—ñ—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤—Å—ñ—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤

## üìã –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω—ñ —Ñ–∞–π–ª–∏

### ‚úÖ –ù–æ–≤—ñ —Ñ–∞–π–ª–∏ (—Å—Ç–≤–æ—Ä–µ–Ω—ñ –≤ —Ü—ñ–π —Å–µ—Å—ñ—ó)

1. **`train/test_runner.py`** ‚úÖ
   - –ú–æ–¥—É–ª—å –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ –ø—Ä–æ–≥—Ä–µ—Å-–±–∞—Ä–æ–º
   - –§—É–Ω–∫—Ü—ñ—ó: `quick_test_model()`, `full_test_model()`, `print_test_results()`
   - –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ: –æ–±—á–∏—Å–ª–µ–Ω–Ω—è `project_root` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—à—É–∫—É –¥–∞—Ç–∞—Å–µ—Ç—ñ–≤
   - –Ü–º–ø–æ—Ä—Ç–∏: –∫–æ—Ä–µ–∫—Ç–Ω—ñ
   - –õ—ñ–Ω—Ç–µ—Ä: –ø–æ–º–∏–ª–æ–∫ –Ω–µ–º–∞—î

2. **`scripts/start_training_with_test.sh`** ‚úÖ
   - –°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è –∑ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–º —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è–º
   - –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ checkpoint'—ñ–≤ –∫–æ–∂–Ω—ñ 5 —Å–µ–∫—É–Ω–¥
   - –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ timeout 5 —Å–µ–∫—É–Ω–¥
   - –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ `train/test_runner.py`
   - –°–∏–Ω—Ç–∞–∫—Å–∏—Å: –∫–æ—Ä–µ–∫—Ç–Ω–∏–π

3. **`scripts/README_TRAINING_WITH_TEST.md`** ‚úÖ
   - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
   - –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

4. **`SCRIPTS_OVERVIEW.md`** ‚úÖ
   - –ü–æ–≤–Ω–∏–π –æ–≥–ª—è–¥ –≤—Å—ñ—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤ –∑–∞–ø—É—Å–∫—É
   - –û–ø–∏—Å –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### ‚úÖ –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏

5. **`scripts/test_model.py`** ‚úÖ
   - –î–æ–¥–∞–Ω–æ –ø—Ä–æ–≥—Ä–µ—Å-–±–∞—Ä (tqdm) –∑ –≤—ñ–¥—Å–æ—Ç–∫–∞–º–∏
   - –ü–æ–∫–∞–∑—É—î —Ç–æ—á–Ω—ñ—Å—Ç—å —Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
   - –õ—ñ–Ω—Ç–µ—Ä: –ø–æ–º–∏–ª–æ–∫ –Ω–µ–º–∞—î

## üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó

### ‚úÖ –Ü–º–ø–æ—Ä—Ç–∏ —Ç–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

- `train/test_runner.py`:
  - ‚úÖ `from inference.model_inference import load_trained_model, TRMInference` - –∫–æ—Ä–µ–∫—Ç–Ω–æ
  - ‚úÖ `from tiny_recursive_model.utils import load_tokenizer` - –∫–æ—Ä–µ–∫—Ç–Ω–æ
  - ‚úÖ `from train.constants import DEFAULT_TOKENIZER_NAME` - –∫–æ—Ä–µ–∫—Ç–Ω–æ

- `scripts/start_training_with_test.sh`:
  - ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `from train.test_runner import quick_test_model, print_test_results` - –∫–æ—Ä–µ–∫—Ç–Ω–æ
  - ‚úÖ –í–∏–∫–ª–∏–∫–∞—î `python scripts/test_model.py` –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç—É - –∫–æ—Ä–µ–∫—Ç–Ω–æ

### ‚úÖ –§—É–Ω–∫—Ü—ñ—ó —Ç–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏

- `quick_test_model()`:
  - ‚úÖ –ü—Ä–∏–π–º–∞—î `model_path: str` - –∫–æ—Ä–µ–∫—Ç–Ω–æ
  - ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `load_trained_model(model_path=model_path, device=device, tokenizer_name=...)` - –∫–æ—Ä–µ–∫—Ç–Ω–æ
  - ‚úÖ –ü–æ–≤–µ—Ä—Ç–∞—î —Å–ª–æ–≤–Ω–∏–∫ –∑ –º–µ—Ç—Ä–∏–∫–∞–º–∏ - –∫–æ—Ä–µ–∫—Ç–Ω–æ

- `load_trained_model()` (–∑ `inference/model_inference.py`):
  - ‚úÖ –ü—Ä–∏–π–º–∞—î `model_path`, `device`, `tokenizer_name` - –∫–æ—Ä–µ–∫—Ç–Ω–æ
  - ‚úÖ –ü–æ–≤–µ—Ä—Ç–∞—î `TRMInference` –æ–±'—î–∫—Ç - –∫–æ—Ä–µ–∫—Ç–Ω–æ

### ‚úÖ –®–ª—è—Ö–∏ —Ç–∞ —Ñ–∞–π–ª–∏

- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è `project_root` –≤ `test_runner.py`:
  - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–æ–±–ª—è—î `checkpoints/checkpoint_latest.pt`
  - ‚úÖ –ó–Ω–∞—Ö–æ–¥–∏—Ç—å `datasets/eval/` —Ç–∞ `datasets/train/`
  - ‚úÖ Fallback –Ω–∞ –ø–æ—à—É–∫ `config/config.yaml` –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è project root

## üìç –†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—ñ–≤

### –°–∫—Ä–∏–ø—Ç–∏ –∑–∞–ø—É—Å–∫—É –Ω–∞–≤—á–∞–Ω–Ω—è

**Linux/macOS:**
- `./start_training.sh` - –±–∞–∑–æ–≤–∏–π –∑–∞–ø—É—Å–∫
- `./scripts/start_training_with_test.sh` ‚≠ê - –Ω–∞–≤—á–∞–Ω–Ω—è –∑ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è–º

**Windows:**
- `start_training.bat` - –±–∞–∑–æ–≤–∏–π –∑–∞–ø—É—Å–∫ (CMD)
- `start_training.ps1` - –±–∞–∑–æ–≤–∏–π –∑–∞–ø—É—Å–∫ (PowerShell)

### –°–∫—Ä–∏–ø—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

**Linux/macOS:**
- `./setup_venv.sh` - —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è venv

**Windows:**
- `setup_venv.bat` - —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è venv (CMD)
- `setup_venv.ps1` - —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è venv (PowerShell)

### –ú–æ–¥—É–ª—ñ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

- `train/test_runner.py` ‚≠ê - –º–æ–¥—É–ª—å —à–≤–∏–¥–∫–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- `scripts/test_model.py` - –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –º–æ–¥–µ–ª—ñ

## ‚úÖ –í—Å—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω–æ

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å
- ‚úÖ –í—Å—ñ Python —Ñ–∞–π–ª–∏ –±–µ–∑ –ø–æ–º–∏–ª–æ–∫ –ª—ñ–Ω—Ç–µ—Ä–∞
- ‚úÖ –í—Å—ñ bash —Å–∫—Ä–∏–ø—Ç–∏ –∑ –∫–æ—Ä–µ–∫—Ç–Ω–∏–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º
- ‚úÖ –í—Å—ñ —ñ–º–ø–æ—Ä—Ç–∏ –∫–æ—Ä–µ–∫—Ç–Ω—ñ

### –õ–æ–≥—ñ–∫–∞
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –º—ñ–∂ –º–æ–¥—É–ª—è–º–∏
- ‚úÖ –ö–æ—Ä–µ–∫—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —à–ª—è—Ö—ñ–≤
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤

### –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å
- ‚úÖ –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ checkpoint'—ñ–≤ –ø—Ä–∞—Ü—é—î
- ‚úÖ –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å-–±–∞—Ä–∏ –¥–æ–¥–∞–Ω–æ
- ‚úÖ –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ –ø—Ä–∏—Å—É—Ç–Ω—è

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó

1. **–î–ª—è Linux/macOS**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `./scripts/start_training_with_test.sh` –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è –∑ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
2. **–î–ª—è Windows**: –ü–æ–∫–∏ —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `start_training.bat` –∞–±–æ `start_training.ps1` (—Å–∫—Ä–∏–ø—Ç –∑ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è–º —Ç—ñ–ª—å–∫–∏ –¥–ª—è Linux)
3. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `python scripts/test_model.py` –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç—É –∞–±–æ `train/test_runner.py` –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ

## üìù –í–∏—Å–Ω–æ–≤–æ–∫

–í—Å—ñ —Å–∫—Ä–∏–ø—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω—ñ —Ç–∞ –≥–æ—Ç–æ–≤—ñ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è. –ù–æ–≤–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø—ñ–¥ —á–∞—Å –Ω–∞–≤—á–∞–Ω–Ω—è –ø—Ä–∞—Ü—é—î –∫–æ—Ä–µ–∫—Ç–Ω–æ.

